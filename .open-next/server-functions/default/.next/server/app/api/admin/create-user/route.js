(()=>{var e={};e.id=758,e.ids=[758],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},8086:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>p,serverHooks:()=>f,workAsyncStorage:()=>c,workUnitAsyncStorage:()=>m});var a={};r.r(a),r.d(a,{POST:()=>l});var n=r(2706),s=r(8203),i=r(5994),u=r(9187),o=r(5369),d=r(2545);async function l(e){try{let t=e.headers.get("X-Setup-Token"),r=process.env.ADMIN_SETUP_TOKEN;if(!r)return u.NextResponse.json({error:"Admin setup is not configured. Please set ADMIN_SETUP_TOKEN environment variable."},{status:500});if(t!==r)return u.NextResponse.json({error:"Invalid setup token"},{status:401});let a=await (0,d.x8)();if(!a)return u.NextResponse.json({error:"Database not configured"},{status:500});let{email:n,password:s,name:i}=await e.json();if(!n||!s)return u.NextResponse.json({error:"Email and password are required"},{status:400});let l=await (0,o.kg)(a,n,s,i||"Admin");return u.NextResponse.json({success:!0,message:"Admin user created successfully",user:{id:l.id,email:l.email,name:l.name}})}catch(e){if(console.error("Create admin user error:",e),e.message?.includes("UNIQUE constraint failed"))return u.NextResponse.json({error:"User with this email already exists"},{status:409});return u.NextResponse.json({error:"Failed to create admin user",details:void 0},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/admin/create-user/route",pathname:"/api/admin/create-user",filename:"route",bundlePath:"app/api/admin/create-user/route"},resolvedPagePath:"C:\\Users\\alk77\\Downloads\\krazywaz-master\\krazywaz-master\\Downloads\\krazywaz\\krazzzzz\\app\\api\\admin\\create-user\\route.ts",nextConfigOutput:"standalone",userland:a}),{workAsyncStorage:c,workUnitAsyncStorage:m,serverHooks:f}=p;function w(){return(0,i.patchFetch)({workAsyncStorage:c,workUnitAsyncStorage:m})}},6487:()=>{},8335:()=>{},5369:(e,t,r)=>{"use strict";r.d(t,{FH:()=>o,kg:()=>d});var a=r(7579),n=r(2545),s=r(6980);async function i(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function u(e,t){return await i(e)===t}async function o(e,t,r){let i=(0,n.Lf)(e),o=await i.select().from(s.users).where((0,a.eq)(s.users.email,t)).get();return o&&await u(r,o.password)?{id:o.id,email:o.email,name:o.name}:null}async function d(e,t,r,a){let u=(0,n.Lf)(e),o=await i(r),d=await u.insert(s.users).values({email:t,password:o,name:a}).returning().get();return{id:d.id,email:d.email,name:d.name}}},2545:(e,t,r)=>{"use strict";r.d(t,{Lf:()=>s,x8:()=>i});var a=r(1205),n=r(6980);function s(e){return(0,a.f)(e,{schema:n})}async function i(){try{let{getCloudflareContext:e}=await r.e(535).then(r.bind(r,6535)),t=await e(),a=t?.env;if(a?.DB)return a.DB}catch(e){}return globalThis.DB?globalThis.DB:null}},6980:(e,t,r)=>{"use strict";r.r(t),r.d(t,{platformLinks:()=>o,shiurim:()=>u,users:()=>i});var a=r(3137),n=r(3161),s=r(7095);let i=(0,a.D)("users",{id:(0,n.Qq)("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),email:(0,n.Qq)("email").notNull().unique(),password:(0,n.Qq)("password").notNull(),name:(0,n.Qq)("name"),createdAt:(0,s.nd)("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date),updatedAt:(0,s.nd)("updated_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),u=(0,a.D)("shiurim",{id:(0,n.Qq)("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),guid:(0,n.Qq)("guid").notNull().unique(),slug:(0,n.Qq)("slug").unique(),title:(0,n.Qq)("title").notNull(),description:(0,n.Qq)("description"),blurb:(0,n.Qq)("blurb"),audioUrl:(0,n.Qq)("audio_url").notNull(),sourceDoc:(0,n.Qq)("source_doc"),pubDate:(0,s.nd)("pub_date",{mode:"timestamp"}).notNull(),duration:(0,n.Qq)("duration"),link:(0,n.Qq)("link"),thumbnail:(0,n.Qq)("thumbnail"),createdAt:(0,s.nd)("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date),updatedAt:(0,s.nd)("updated_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),o=(0,a.D)("platform_links",{id:(0,n.Qq)("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),shiurId:(0,n.Qq)("shiur_id").notNull().unique().references(()=>u.id,{onDelete:"cascade"}),youtube:(0,n.Qq)("youtube"),youtubeMusic:(0,n.Qq)("youtube_music"),spotify:(0,n.Qq)("spotify"),apple:(0,n.Qq)("apple"),amazon:(0,n.Qq)("amazon"),pocket:(0,n.Qq)("pocket"),twentyFourSix:(0,n.Qq)("twenty_four_six"),castbox:(0,n.Qq)("castbox"),createdAt:(0,s.nd)("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date),updatedAt:(0,s.nd)("updated_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,920,452],()=>r(8086));module.exports=a})();