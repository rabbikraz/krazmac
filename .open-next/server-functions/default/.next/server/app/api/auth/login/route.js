(()=>{var e={};e.id=377,e.ids=[377],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},964:(e,t,a)=>{"use strict";a.r(t),a.d(t,{patchFetch:()=>q,routeModule:()=>m,serverHooks:()=>y,workAsyncStorage:()=>w,workUnitAsyncStorage:()=>f});var r={};a.r(r),a.d(r,{DELETE:()=>c,POST:()=>p});var n=a(2706),s=a(8203),i=a(5994),o=a(9187),u=a(5369),d=a(4512),l=a(2545);async function p(e){try{let t=await (0,l.x8)();if(!t)return console.error("D1 database not available"),o.NextResponse.json({error:"Database not configured."},{status:500});let{email:a,password:r}=await e.json();if(!a||!r)return o.NextResponse.json({error:"Email and password are required"},{status:400});let n=await (0,u.FH)(t,a,r);if(!n)return o.NextResponse.json({error:"Invalid credentials"},{status:401});return(await (0,d.UL)()).set("admin-session",n.id,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800}),o.NextResponse.json({success:!0,user:{id:n.id,email:n.email,name:n.name}})}catch(e){return console.error("Login error:",e),o.NextResponse.json({error:"Internal server error",details:void 0},{status:500})}}async function c(){return(await (0,d.UL)()).delete("admin-session"),o.NextResponse.json({success:!0})}let m=new n.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Users\\alk77\\Downloads\\krazywaz-master\\krazywaz-master\\Downloads\\krazywaz\\krazzzzz\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"standalone",userland:r}),{workAsyncStorage:w,workUnitAsyncStorage:f,serverHooks:y}=m;function q(){return(0,i.patchFetch)({workAsyncStorage:w,workUnitAsyncStorage:f})}},6487:()=>{},8335:()=>{},5369:(e,t,a)=>{"use strict";a.d(t,{FH:()=>u,kg:()=>d});var r=a(7579),n=a(2545),s=a(6980);async function i(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>e.toString(16).padStart(2,"0")).join("")}async function o(e,t){return await i(e)===t}async function u(e,t,a){let i=(0,n.Lf)(e),u=await i.select().from(s.users).where((0,r.eq)(s.users.email,t)).get();return u&&await o(a,u.password)?{id:u.id,email:u.email,name:u.name}:null}async function d(e,t,a,r){let o=(0,n.Lf)(e),u=await i(a),d=await o.insert(s.users).values({email:t,password:u,name:r}).returning().get();return{id:d.id,email:d.email,name:d.name}}},2545:(e,t,a)=>{"use strict";a.d(t,{Lf:()=>s,x8:()=>i});var r=a(1205),n=a(6980);function s(e){return(0,r.f)(e,{schema:n})}async function i(){try{let{getCloudflareContext:e}=await a.e(535).then(a.bind(a,6535)),t=await e(),r=t?.env;if(r?.DB)return r.DB}catch(e){}return globalThis.DB?globalThis.DB:null}},6980:(e,t,a)=>{"use strict";a.r(t),a.d(t,{platformLinks:()=>u,shiurim:()=>o,users:()=>i});var r=a(3137),n=a(3161),s=a(7095);let i=(0,r.D)("users",{id:(0,n.Qq)("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),email:(0,n.Qq)("email").notNull().unique(),password:(0,n.Qq)("password").notNull(),name:(0,n.Qq)("name"),createdAt:(0,s.nd)("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date),updatedAt:(0,s.nd)("updated_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),o=(0,r.D)("shiurim",{id:(0,n.Qq)("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),guid:(0,n.Qq)("guid").notNull().unique(),slug:(0,n.Qq)("slug").unique(),title:(0,n.Qq)("title").notNull(),description:(0,n.Qq)("description"),blurb:(0,n.Qq)("blurb"),audioUrl:(0,n.Qq)("audio_url").notNull(),sourceDoc:(0,n.Qq)("source_doc"),pubDate:(0,s.nd)("pub_date",{mode:"timestamp"}).notNull(),duration:(0,n.Qq)("duration"),link:(0,n.Qq)("link"),thumbnail:(0,n.Qq)("thumbnail"),createdAt:(0,s.nd)("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date),updatedAt:(0,s.nd)("updated_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)}),u=(0,r.D)("platform_links",{id:(0,n.Qq)("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),shiurId:(0,n.Qq)("shiur_id").notNull().unique().references(()=>o.id,{onDelete:"cascade"}),youtube:(0,n.Qq)("youtube"),youtubeMusic:(0,n.Qq)("youtube_music"),spotify:(0,n.Qq)("spotify"),apple:(0,n.Qq)("apple"),amazon:(0,n.Qq)("amazon"),pocket:(0,n.Qq)("pocket"),twentyFourSix:(0,n.Qq)("twenty_four_six"),castbox:(0,n.Qq)("castbox"),createdAt:(0,s.nd)("created_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date),updatedAt:(0,s.nd)("updated_at",{mode:"timestamp"}).notNull().$defaultFn(()=>new Date).$onUpdate(()=>new Date)})}};var t=require("../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[638,920,452,512],()=>a(964));module.exports=r})();